### Задеплоенное приложение находится по адресу https://glossary-app.acherenkov.tech/

### Статическая документация доступна по адресу https://glossary-app.acherenkov.tech/static-docs

---

# Отчёт по лабораторной работе: «Glossary App на FastAPI»

## 1. Цель и задачи лабораторной работы

В ходе выполнения лабораторной работы необходимо было создать сервис на базе **FastAPI** для управления терминологическим глоссарием (словарём терминов). Основные задачи:

- Реализовать операции CRUD над терминами (создание, чтение, обновление, удаление).
- Использовать **Pydantic** для валидации входных данных и генерации схем ответов.
- Обеспечить хранение данных в **SQLite**.
- Сгенерировать **OpenAPI**-спецификацию и предоставить к ней Swagger UI / ReDoc документацию.
- (Дополнительно) Сформировать статический вариант документации на основе OpenAPI-спецификации.
- (Дополнительно) Организовать запуск приложения через Docker и выполнить деплой на сервере (VDS) с использованием HTTPS.

## 2. Структура проекта

```bash
glossary_app
├── app
│   ├── main.py         # Точка входа (FastAPI-приложение)
│   ├── database.py     # Настройка подключения к SQLite
│   ├── models.py       # SQLAlchemy-модель (Term)
│   ├── schemas.py      # Pydantic-схемы (TermCreate, TermUpdate, TermOut)
│   └── crud.py         # CRUD-функции (create, read, update, delete)
├── Dockerfile          # (Опционально) для сборки Docker-образа
├── requirements.txt    # Список зависимостей
├── README.md           # Отчёт (вы сейчас его читаете)
└── redoc-static.html   # (Опционально) статически сгенерированная документация
```

1. **app/main.py**  
   Содержит точку входа в приложение FastAPI и роуты (эндпоинты) для CRUD-операций.
2. **app/database.py**  
   Предоставляет объекты `engine`, `SessionLocal` и базовый класс `Base` (declarative base) для работы с SQLite.
3. **app/models.py**  
   Описание таблицы `terms` при помощи SQLAlchemy.
4. **app/schemas.py**  
   Описание Pydantic-схем для приёма/выдачи данных по терминологии.
5. **app/crud.py**  
   Логика создания, чтения, обновления и удаления записей в базе данных.
6. **Dockerfile**  
   Файл, позволяющий упаковать приложение в Docker-контейнер (если используется).
7. **redoc-static.html**  
   Пример статического HTML-файла документации, сгенерированного на основе OpenAPI-спецификации.

## 3. Используемые технологии

- **Python 3.9+**, фреймворк **FastAPI**
- **SQLAlchemy** для взаимодействия с SQLite
- **Pydantic** для описания и валидации схем
- **Uvicorn** для запуска FastAPI
- (Опционально) **Docker** для контейнеризации
- (Опционально) **Nginx** и **certbot** для деплоя на VDS с HTTPS

## 4. Описание эндпоинтов

1. **Получение списка терминов**  
   **Метод**: `GET /terms`  
   **Описание**: Возвращает список всех терминов с их описанием.

2. **Получение конкретного термина**  
   **Метод**: `GET /terms/{term_key}`  
   **Описание**: По ключу `term_key` возвращает данные о соответствующем термине.

3. **Создание нового термина**  
   **Метод**: `POST /terms`  
   **Тело запроса (JSON)**:
   ```json
   {
     "key": "internet",
     "description": "Глобальная сеть"
   }
   ```
   **Описание**: Добавляет новый термин в глоссарий. При дублировании ключа возвращает ошибку.

4. **Обновление существующего термина**  
   **Метод**: `PUT /terms/{term_key}`  
   **Тело запроса (JSON)** (может меняться в зависимости от схемы):
   ```json
   {
     "description": "Всемирная паутина"
   }
   ```
   **Описание**: Изменяет описание ранее созданного термина (по ключу).

5. **Удаление термина**  
   **Метод**: `DELETE /terms/{term_key}`  
   **Описание**: Удаляет термин из глоссария. При отсутствии — возвращает 404 Not Found.

## 5. Инструкция по запуску (локально)

1. **Клонирование репозитория**:
   ```bash
   git clone <URL_репозитория>
   cd glossary_app
   ```
2. **Установка зависимостей** (рекомендуется использовать виртуальное окружение):
   ```bash
   pip install -r requirements.txt
   ```
3. **Запуск приложения**:
   ```bash
   uvicorn app.main:app --reload
   ```
4. **Проверка работы**:
    - Перейдите в браузере на [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs) для доступа к Swagger UI.
    - Или [http://127.0.0.1:8000/redoc](http://127.0.0.1:8000/redoc) для Redoc.

## 6. Примеры запросов (через curl)

1. **Добавление термина**:
   ```bash
   curl -X POST "https://glossary-app.acherenkov.tech/terms" \
        -H "Content-Type: application/json" \
        -d '{"key": "internet", "description": "Глобальная сеть"}'
   ```
2. **Получение списка всех терминов**:
   ```bash
   curl "https://glossary-app.acherenkov.tech/terms"
   ```
3. **Обновление термина**:
   ```bash
   curl -X PUT "https://glossary-app.acherenkov.tech/terms/internet" \
        -H "Content-Type: application/json" \
        -d '{"description": "Всемирная паутина"}'
   ```
4. **Удаление термина**:
   ```bash
   curl -X DELETE "https://glossary-app.acherenkov.tech/terms/internet"
   ```

## 7. Формирование статической документации

Для автоматического получения статического HTML на базе OpenAPI-спецификации можно воспользоваться инструментами, например, **@redocly/cli**:

1. Установить Node.js и npm (если ещё не установлено).
2. Запустить приложение (чтобы `/openapi.json` было доступно).
3. Выполнить команду:
   ```bash
   npx @redocly/cli build-docs http://127.0.0.1:8000/openapi.json
   ```
   Результирующие HTML-файлы будут готовы к раздаче как статические файлы (например, через Nginx).

## 8. Запуск в Docker (при необходимости)

1. Убедитесь, что Docker установлен.
2. Соберите образ:
   ```bash
   docker build -t glossary-app .
   ```
3. Запустите контейнер:
   ```bash
   docker run -d --name glossary_container -p 8000:8000 glossary-app
   ```
4. Приложение станет доступно на `http://127.0.0.1:8000`.

## 9. Деплой на сервер (VDS)

- **Nginx** сконфигурирован для проксирования запросов на локально работающий Uvicorn (FastAPI).
- **Certbot** настроен для получения бесплатных сертификатов Let’s Encrypt, чтобы обеспечить HTTPS.
- `redoc-static.html` раздается при помощи `Nginx` по ссылке https://glossary-app.acherenkov.tech/static-docs/.
